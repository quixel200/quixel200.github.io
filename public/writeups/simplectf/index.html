<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Simple CTF :: quixel200</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Simple CTF - TryHackMe How many services are running under port 1000? To know what services are running on the ports, we can use nmap, a network mapping tool. Here&rsquo;s the command I used:
nmap -sV -sC &lt;ip&gt; -p- -T4 Here&rsquo;s what the command does:
sV - probes for service and version info sC - runs scripts against the port (default scripts) -p- specifies to scan all the ports T4 - makes the scan run faster taking less time A scan of all the ports can take some time, so you can omit the -p- option for now.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://quixel200.github.io/writeups/simplectf/" />





  
  <link rel="stylesheet" href="https://quixel200.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terminal.min.b9fcf12f2827d468ddb6580a4de4fb1f7e8ce515cea5b1d07444aecd8e1b6bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="https://quixel200.github.io/favicon.png">
<link rel="apple-touch-icon" href="https://quixel200.github.io/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Simple CTF">
<meta property="og:description" content="Simple CTF - TryHackMe How many services are running under port 1000? To know what services are running on the ports, we can use nmap, a network mapping tool. Here&rsquo;s the command I used:
nmap -sV -sC &lt;ip&gt; -p- -T4 Here&rsquo;s what the command does:
sV - probes for service and version info sC - runs scripts against the port (default scripts) -p- specifies to scan all the ports T4 - makes the scan run faster taking less time A scan of all the ports can take some time, so you can omit the -p- option for now.
" />
<meta property="og:url" content="https://quixel200.github.io/writeups/simplectf/" />
<meta property="og:site_name" content="quixel200" />

  <meta property="og:image" content="https://quixel200.github.io/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-08-18 15:26:12 &#43;0530 IST" />




  <link href="/writeups/simplectf/index.xml" rel="alternate" type="application/rss+xml" title="quixel200" />









</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/articles">Articles</a></li>
        
      
        
          <li><a href="/notes">Notes</a></li>
        
      
        
          <li><a href="/projects">Projects</a></li>
        
      
        
          <li><a href="/writeups">Writeups</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/articles" >Articles</a></li>
        
      
        
          <li><a href="/notes" >Notes</a></li>
        
      
        
          <li><a href="/projects" >Projects</a></li>
        
      
        
          <li><a href="/writeups" >Writeups</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  
    <div class="index-content">
      <h1 id="simple-ctf---tryhackme">Simple CTF - TryHackMe</h1>
<h2 id="how-many-services-are-running-under-port-1000">How many services are running under port 1000?</h2>
<p>To know what services are running on the ports, we can use nmap, a network mapping tool. Here&rsquo;s the command I used:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -sV -sC &lt;ip&gt; -p- -T4
</span></span></code></pre></div><p>Here&rsquo;s what the command does:</p>
<pre tabindex="0"><code>sV - probes for service and version info
sC - runs scripts against the port (default scripts)
-p- specifies to scan all the ports
T4 - makes the scan run faster taking less time
</code></pre><p>A scan of all the ports can take some time, so you can omit the <code>-p-</code> option for now.</p>
<p><img src="/writeups/simplectf/images/nmap_port_scan.png" alt="Nmap Port Scan"></p>
<p>We can see three ports open: 21, 80 and 2222, but the question asks for ports under 1000, which is 2.</p>
<h2 id="what-is-running-on-the-higher-port">What is running on the higher port?</h2>
<p>From the nmap scan we can see that SSH is running on the higher port.</p>
<h2 id="whats-the-cve-youre-using-against-the-application">What&rsquo;s the CVE you&rsquo;re using against the application?</h2>
<p>In the nmap scan we can notice that the FTP server allows for anonymous logins. FTP allows for file sharing in a network, with anonymous logins, we can see the files without being an authorized user.</p>
<p><img src="/writeups/simplectf/images/ftplogin.png" alt="FTP Login"></p>
<p>We can see a note left by someone, here&rsquo;s the contents of the file:</p>
<p>&ldquo;Dammit man&hellip; you&rsquo;re the worst dev i&rsquo;ve seen. You set the same pass for the system user, and the password is so weak&hellip; i cracked it in seconds. Gosh&hellip; what a mess!&rdquo;</p>
<p>This tells us that brute force is an option if we come across a hash or a login page.</p>
<p>Opening the webpage that&rsquo;s running on port 80, we can see the default Apache2 homepage. In the Nmap scan, we can also see that it discovered robots.txt as a page we can visit. This was because we ran the default scripts on nmap. Here&rsquo;s the line we&rsquo;re interested in:</p>
<pre tabindex="0"><code>Disallow: /openemr-5_0_1_3
</code></pre><p>But when we visit the URL, it doesn&rsquo;t exist and turns out to be a rabbit hole that leads us nowhere.</p>
<p>After that I tried to search for hidden directories using ffuf and I found a hidden page:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffuf -w wordlist.txt -u http://target/FUZZ
</span></span></code></pre></div><pre tabindex="0"><code>-w wordlist to use
-u url of the page (FUZZ specifies the place to substitute)
</code></pre><p><img src="/writeups/simplectf/images/directory.png" alt="Directory Discovery"></p>
<h2 id="to-what-kind-of-vulnerability-is-the-application-vulnerable">To what kind of vulnerability is the application vulnerable?</h2>
<p>Going to <code>/simple</code>, we see that it&rsquo;s running something called &ldquo;CMS Made Simple&rdquo;, the important information is the version which is 2.2.8. Googling for exploits we see that it&rsquo;s vulnerable to a <a href="https://www.exploit-db.com/exploits/46635">SQL Injection (SQLi) attack</a>.</p>
<p>I am going to use <a href="https://github.com/ELIZEUOPAIN/CVE-2019-9053-CMS-Made-Simple-2.2.10---SQL-Injection-Exploit">this</a> GitHub repo code in order to perform the attack and get the credentials:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python exploit.py -u http://ip/simple --crack -w best110.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Salt <span class="k">for</span> password found: 1dac0d**********
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Username found: mitch
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Email found: admin@admin.com
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Password found: 0c01d4468b****************
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Password cracked: ******
</span></span></code></pre></div><h2 id="where-can-you-login-with-the-details-obtained">Where can you login with the details obtained?</h2>
<p>We can now use the credentials we just cracked to log into SSH. This is a common example of re-using the same credentials for everything.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh mitch@ip -p <span class="m">2222</span>
</span></span></code></pre></div><h2 id="whats-the-user-flag">What&rsquo;s the user flag?</h2>
<p>The user flag can be found in the user&rsquo;s home directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat user.txt
</span></span></code></pre></div><h2 id="is-there-any-other-user-in-the-home-directory-whats-its-name">Is there any other user in the home directory? What&rsquo;s its name?</h2>
<p>Going to <code>/home</code>, we see another user by the name of <strong>sunbath</strong>.</p>
<h2 id="what-can-you-leverage-to-spawn-a-privileged-shell">What can you leverage to spawn a privileged shell?</h2>
<p>Checking what commands we can run as root on the server, we can see vim which can be run as root with no password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo -l
</span></span><span class="line"><span class="cl">User mitch may run the following commands on Machine:
</span></span><span class="line"><span class="cl"><span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/vim
</span></span></code></pre></div><h2 id="whats-the-root-flag">What&rsquo;s the root flag?</h2>
<p>To escalate our privileges to root, we can check GTFObins and search for vim. We can easily spawn a root shell by following the instructions provided on <a href="https://gtfobins.github.io/gtfobins/vim/">their page</a>, it&rsquo;s a simple command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo vim -c <span class="s1">&#39;:!/bin/sh&#39;</span>
</span></span></code></pre></div><p>Once we&rsquo;re root, we can find the root flag in the root user&rsquo;s home directory:</p>
<p><img src="/writeups/simplectf/images/root.png" alt="Root Flag"></p>

    </div>
  
  <div class="posts">
    

    <div class="pagination">
  <div class="pagination__buttons">
    
    
    
  </div>
</div>

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
