<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>whoami Command Detection in Request Body :: quixel200</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Let&rsquo;s investigate a potential command injection alert on letsdefend.io
The alert generated was:
The request was sent to the URL https://172.16.17.16/video/ (hostname is WebServer1004).
Let&rsquo;s first take a look at the log files and filter for the URL in the raw logs. Filtering helps us skip through manually looking at each log which can get pretty tedious.
Taking a look at the detailed log output, we can see that the user ran whoami using the c post paramter.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://quixel200.github.io/writeups/whoami_command_detection/" />





  
  <link rel="stylesheet" href="https://quixel200.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terminal.min.b9fcf12f2827d468ddb6580a4de4fb1f7e8ce515cea5b1d07444aecd8e1b6bbe.css">

  
  <link rel="stylesheet" href="https://quixel200.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="https://quixel200.github.io/favicon.png">
<link rel="apple-touch-icon" href="https://quixel200.github.io/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="whoami Command Detection in Request Body">
<meta property="og:description" content="Let&rsquo;s investigate a potential command injection alert on letsdefend.io
The alert generated was:
The request was sent to the URL https://172.16.17.16/video/ (hostname is WebServer1004).
Let&rsquo;s first take a look at the log files and filter for the URL in the raw logs. Filtering helps us skip through manually looking at each log which can get pretty tedious.
Taking a look at the detailed log output, we can see that the user ran whoami using the c post paramter.
" />
<meta property="og:url" content="https://quixel200.github.io/writeups/whoami_command_detection/" />
<meta property="og:site_name" content="quixel200" />

  <meta property="og:image" content="https://quixel200.github.io/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-08-23 08:28:22 &#43;0530 IST" />




  <link href="/writeups/whoami_command_detection/index.xml" rel="alternate" type="application/rss+xml" title="quixel200" />









</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/articles">Articles</a></li>
        
      
        
          <li><a href="/notes">Notes</a></li>
        
      
        
          <li><a href="/projects">Projects</a></li>
        
      
        
          <li><a href="/writeups">Writeups</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/articles" >Articles</a></li>
        
      
        
          <li><a href="/notes" >Notes</a></li>
        
      
        
          <li><a href="/projects" >Projects</a></li>
        
      
        
          <li><a href="/writeups" >Writeups</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  
    <div class="index-content">
      <p>Let&rsquo;s investigate a potential command injection alert on <a href="https://letsdefend.io/">letsdefend.io</a></p>
<p>The alert generated was:</p>
<p><img src="/writeups/whoami_command_detection/images/siem_alert.png" alt="siem alert"></p>
<p>The request was sent to the URL <code>https://172.16.17.16/video/</code> (hostname is WebServer1004).</p>
<p>Let&rsquo;s first take a look at the log files and filter for the URL in the raw logs. Filtering helps us skip through manually looking at each log which can get pretty tedious.</p>
<p><img src="/writeups/whoami_command_detection/images/log_filtering.png" alt="log filtering"></p>
<p>Taking a look at the detailed log output, we can see that the user ran <code>whoami</code> using the <code>c</code> post paramter.</p>
<p><img src="/writeups/whoami_command_detection/images/whoami_command.png" alt="whoami command"></p>
<p>The user also ran 2 other commands, the most important of which is <code>cat /etc/shadow</code>. The shadow file contains the hashed passwords of the users which the attacker could potentially crack with a weak enough password.</p>
<p><img src="/writeups/whoami_command_detection/images/shadow_file_extraction.png" alt="shadow file extraction"></p>
<p>Although it returns a response code of 200 (success) it might not have actually run the command. So we should check the host on endpoint security and see the terminal history.</p>
<p><img src="/writeups/whoami_command_detection/images/terminal_history.png" alt="terminal history"></p>
<p>The commands were run successfully which means the attacker succeeded, our next priority should be to isolate the machine and escalate the incident. The escalation is necessary due to the high severity of the vulnerability.</p>
<p>We will also add the malicious IP to the artifacts
<img src="/writeups/whoami_command_detection/images/artifacts.png" alt="malicious IP artifact"></p>
<h2 id="is-traffic-malicious">Is traffic malicious?</h2>
<p>Yes, clearly the attacker was trying to gain sensitive information from the system.</p>
<h2 id="what-is-the-attack-type">What is the attack type?</h2>
<p>This is a command injection vulnerability that allows attackers to run arbitrary commands on the host system</p>
<h2 id="was-the-attack-a-planned-test">Was the attack a planned test?</h2>
<p>Checking the emails, we don&rsquo;t see any indication that a test was planned during the time of the attack.</p>
<h2 id="what-is-the-direction-of-traffic">What is the direction of traffic?</h2>
<p>The source IP is an IP that is outside the company network.
Internet -&gt; company network</p>
<h2 id="was-the-attack-successful">Was the attack successful?</h2>
<p>Yes, we see 200 status codes and the corresponding command being run on the host.</p>
<h2 id="is-a-tier-2-escalation-needed">is a tier 2 escalation needed?</h2>
<p>Yes</p>
<h2 id="my-analysis-notes">My analysis notes</h2>
<p><img src="/writeups/whoami_command_detection/images/analyst_note.png" alt="analysis_notes"></p>
<p>Any feedback is welcome as I am still learning, thank you for reading and have fun learning!</p>

    </div>
  
  <div class="posts">
    

    <div class="pagination">
  <div class="pagination__buttons">
    
    
    
  </div>
</div>

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
